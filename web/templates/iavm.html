{% extends 'layouts/master-page' %}
{% block title %}IAVM Notice {% if notice_number %}{{notice_number}}{% else %}Browsing{% endif %} {% endblock %}

{% block head %}

  <!-- css -->
  <link href="/static/css/custom/filter.css" rel="stylesheet" />

  <!-- javascript -->
  <script type="text/javascript" src="/static/js/custom/filter.js"></script>
  <script type="text/javascript" src="/static/js/custom/table.js"></script>
  <script type="text/javascript">
    function postURL(url) {
      var form = document.getElementById("filter");
      form.action = url;
      form.submit();
    }
    function getr() {
      return {{r}};
    }
    function next(n) {
      var multiplier = {{ r }} + ( n * {{ pageLength }} );
      var url = "/iavm/r/"+multiplier;
      postURL(url);
    }
    function previous(n) {
      var page = {{ r }} - ( n * {{ pageLength }} );
      if(page < 0) {
        page = 0;
      }
      var url = "/iavm/r/" + page;
      postURL(url);
    }
  </script>
{% endblock %}

{% block content %}

  <!-- Filter options -->
  <div id="filterdiv" class="collapse well well-small">
    <form method="POST" id="filter" class="nav form-search" onsubmit="/filter"></form>
  </div>

  <!-- Pager -->
  {% if not notice_number %}
  {% include 'subpages/pager.html' %}
  {% endif %}

  <div>
    <table class="table table-hover table-striped">
    {% if notice_number %}
    <!-- breadcrumb -->
    <ol class="breadcrumb">
      <li><a href="/iavm">IAVM</a></li>
      <li class="active">{{iavm.id}}</li>
    </ol>

    <tbody>
      <tr><td class="warning">Notice Number  </td><td class="info"><b>{{iavm.id}}</b></td></tr>
      <tr><td class="warning">Title          </td><td class="info">{{iavm.title}}</td></tr>
      <tr><td class="warning">Severity       </td><td class="info">{{iavm.severity}}</td></tr>
      <tr>
        <td class="warning">Vulnerable Configurations</td>
        <td>
          <div class="colfield semiCollapsed">
            <ul class="block">
              {% for vulconf in iavm['vulnerable_configuration'] %}
                <li
                  {% if vulconf['list'] == 'white' %}
                    class="whitelisted"
                  {% elif vulconf['list'] == 'black' %}
                    class="blacklisted"
                  {% endif %}
                  title="{{ vulconf['id'] }} matches {{ vulconf['match'] }}">
                  <span data-toggle="collapse" data-target="#v{{ loop.index }}" > {{ vulconf['title'] }}</span>
                  <div id="v{{ loop.index }}" class="collapse">{{ vulconf['id'] }}</div>
                </li>
              {% endfor %}
            </ul>
          </div>
        </td>
      </tr>
      <tr><td class="warning">Related CVEs</td>
        <td class="info">
          <table>
            <tr class="warning"><td><b>CVE ID</b></td></tr>
            {% for cve in iavm.cve %}
            <tr><td><a href="/cve/{{cve}}">{{cve}}</a></td</tr>
            {% endfor %}
          </table>
        </td>
      </tr>
    </tbody>
    {% else %}
    <tbody>
      <tr><td class="warning">Notice Number</td><td class="warning">Title</td><td class="warning">Severity</td></tr>
      {% for iavm in iavms %}
      <tr><td><a href="/iavm/{{iavm.id}}">{{iavm.id}}</a></td><td>{{iavm.title}}</td><td>{{iavm.severity}}</td></tr>
      {% endfor %}
    </tbody>
    {% endif %}
    </table>
  </div>

  <!-- Pager -->
  {% if not notice_number %}
  {% include 'subpages/pager.html' %}
  {% endif %}

{% endblock %}
